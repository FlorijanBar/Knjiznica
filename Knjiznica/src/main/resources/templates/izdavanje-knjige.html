<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Knjiznica</title>
</head>
<body>

<h1>Sve knjige</h1>
<table>
    <tr>
        <th>ID</th>
        <th>Naziv</th>
        <th>Autor</th>
        <th>Akcije</th>
    </tr>
    <tr th:each="knjiga : ${knjige}">
        <td th:text="${knjiga.id}"></td>
        <td th:text="${knjiga.naziv}"></td>
        <td th:text="${knjiga.autor}"></td>
        <td>
            <a th:href="@{/api/knjiga/{id}(id=${knjiga.id})}">Prikaži</a>
            <a th:href="@{/api/knjiga/{id}/update(id=${knjiga.id})}">Uredi</a>
            <a th:href="@{/api/knjiga/{id}/delete(id=${knjiga.id})}">Izbriši</a>
        </td>
    </tr>
</table>

<h1>Izdavanje knjige</h1>
<form th:action="@{/api/knjiga/izdaj}" method="post">
    <label for="student">Student:</label>
    <select id="student" name="studentId" required>
        <option th:each="student : ${studenti}" th:value="${student.id}" th:text="${student.ime} + ' ' + ${student.prezime}"></option>
    </select>
    <br>
    <label for="knjiga">Knjiga:</label>
    <select id="knjiga" name="knjigaId" required>
        <option th:each="knjiga : ${knjige}" th:value="${knjiga.id}" th:text="${knjiga.naziv}"></option>
    </select>
    <br>
    <br>
    <label for="datumIzdavanja">Datum izdavanja:</label>
    <input type="date" id="datumIzdavanja" name="datumIzdavanja" required>
    <br>
    <br>
    <label for="datumVracanja">Datum vraćanja:</label>
    <input type="date" id="datumVracanja" name="datumVracanja" required>
    <br>
    <input type="submit" value="Izdaj">
</form>




<h1>Provjera statusa izdavanja knjige</h1>
<form id="provjeraForma" th:action="@{/api/knjiga/{knjigaId}/status(knjigaId=${knjigaId})}" method="get">
    <label for="knjigaStatus">Unesite ID knjige:</label>
    <input type="text" id="knjigaStatus" name="knjigaId" required>
    <br>
    <input type="submit" value="Provjeri">
</form>

<h1>Pregled izdanih knjiga za studenta</h1>
<form id="pregledIzdanihKnjigaForm" th:action="@{/api/knjiga/student/{studentId}/izdane-knjige(studentId=${studentId})}" method="get">
    <label for="studentIzdaneKnjige">Unesite ID studenta:</label>
    <input type="text" id="studentIzdaneKnjige" name="studentId" required>
    <br>
    <input type="submit" value="Prikaži">
</form>
<h1>Vraćanje knjige</h1>
<form th:action="@{/api/knjiga/vratiKnjigu}" method="post">
    <label for="studentId">Student:</label>
    <select id="studentId" name="studentId" required>
        <option value="">Odaberite studenta</option>
        <option th:each="student : ${studenti}" th:value="${student.id}" th:text="${student.id + ' - ' + student.ime + ' ' + student.prezime}"></option>
    </select><br><br>

    <label for="knjigaId">Knjiga:</label>
    <select id="knjigaId" name="knjigaId" required>
        <option value="">Odaberite knjigu</option>
        <option th:each="knjiga : ${knjige}" th:value="${knjiga.id}" th:text="${knjiga.naziv}"></option>
    </select><br><br>

    <input type="submit" value="Vrati knjigu">
</form>





<script>

        
        
document.getElementById('provjeraForma').addEventListener('submit', function(e) {
            e.preventDefault(); // Spriječi podnošenje obrasca

            var knjigaId = document.getElementById('knjigaStatus').value; // Dohvati uneseni ID knjige
            var form = this;

            form.action = '/api/knjiga/' + knjigaId + '/status'; // Ažuriraj akcijsku putanju s novim ID-om knjige
            form.submit(); // Podnesi obrazac
        });
        
document.getElementById('pregledIzdanihKnjigaForm').addEventListener('submit', function(e) {
          e.preventDefault(); // Spriječi podnošenje obrasca

          var studentId = document.getElementById('studentIzdaneKnjige').value; // Dohvati ID odabranog studenta
          var form = this;

          form.action = '/api/knjiga/student/' + studentId + '/izdane-knjige'; // Ažuriraj akcijsku putanju s novim ID-om studenta
          form.submit(); // Podnesi obrazac
      });
        
</script>
</body>
</html>
